$((function(){"use strict";var a,t=!0,e=$(".kanban-wrapper"),n=$(".update-item-sidebar"),d=$("#due-date"),i=$(".select2"),o=$(".comment-editor"),s=$(".add-new-board"),r=$(".update-item-sidebar"),l=$(".add-new-board-input"),c="../../../app-assets/";if("laravel"===$("body").attr("data-framework")&&(c=$("body").attr("data-asset-path")),$.ajax({type:"GET",dataType:"json",async:!1,url:c+"data/kanban.json",success:function(t){a=t}}),l.toggle(),d.length&&d.flatpickr({monthSelectorType:"static",altInput:!0,altFormat:"j F, Y",dateFormat:"Y-m-d"}),i.length){function m(a){return a.id?"<div class='badge "+$(a.element).data("color")+" badge-pill'> "+a.text+"</div>":a.text}i.each((function(){var a=$(this);a.wrap("<div class='position-relative'></div>").select2({placeholder:"Select Label",dropdownParent:a.parent(),templateResult:m,templateSelection:m,escapeMarkup:function(a){return a}})}))}function p(){return"<div class='dropdown'>"+feather.icons["more-vertical"].toSvg({class:"dropdown-toggle cursor-pointer font-medium-3 mr-0",id:"board-dropdown","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"})+"<div class='dropdown-menu dropdown-menu-right' aria-labelledby='board-dropdown'><a class='dropdown-item delete-board' href='javascript:void(0)'> "+feather.icons.trash.toSvg({class:"font-medium-1 align-middle"})+"<span class='align-middle ml-25'>Delete</span></a><a class='dropdown-item' href='javascript:void(0)'>"+feather.icons.edit.toSvg({class:"font-medium-1 align-middle"})+"<span class='align-middle ml-25'>Rename</span></a><a class='dropdown-item' href='javascript:void(0)'>"+feather.icons.archive.toSvg({class:"font-medium-1 align-middle"})+"<span class='align-middle ml-25'>Archive</span></a></div></div>"}function u(){return"<div class='dropdown item-dropdown px-1'>"+feather.icons["more-vertical"].toSvg({class:"dropdown-toggle cursor-pointer mr-0 font-medium-1",id:"item-dropdown"," data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"})+"<div class='dropdown-menu dropdown-menu-right' aria-labelledby='item-dropdown'><a class='dropdown-item' href='javascript:void(0)'>Copy task link</a><a class='dropdown-item' href='javascript:void(0)'>Duplicate task</a><a class='dropdown-item delete-task' href='javascript:void(0)'>Delete</a></div></div>"}function b(a,t){return"<div class='d-flex justify-content-between flex-wrap align-items-center mb-1'><div class='item-badges'> <div class='badge badge-pill badge-light-"+a+"'> "+t+"</div></div>"+u()+"</div>"}function v(a,t,e,n,d){var i=t?" pull-up":"",o=void 0!==n?n.split(","):"";return void 0!==a?a.split(",").map((function(a,t,n){var s=void 0!==e&&t!==n.length-1?" mr-"+e:"";return"<li class='avatar kanban-item-avatar "+i+" "+s+"'data-toggle='tooltip' data-placement='top'title='"+o[t]+"'><img src='"+c+"images/portrait/small/"+a+"' alt='Avatar' height='"+d+"'></li>"})).join(" "):""}function f(a,t,e,n){return"<div class='d-flex justify-content-between align-items-center flex-wrap mt-1'><div> <span class='align-middle mr-50'>"+feather.icons.paperclip.toSvg({class:"font-medium-1 align-middle mr-25"})+"<span class='attachments align-middle'>"+a+"</span></span> <span class='align-middle'>"+feather.icons["message-square"].toSvg({class:"font-medium-1 align-middle mr-25"})+"<span>"+t+"</span></span></div><ul class='avatar-group mb-0'>"+v(e,!0,0,n,28)+"</ul></div>"}o.length&&new Quill(".comment-editor",{modules:{toolbar:".comment-toolbar"},placeholder:"Write a Comment... ",theme:"snow"});var g=new jKanban({element:".kanban-wrapper",gutter:"15px",widthBoard:"250px",dragItems:!0,boards:a,dragBoards:!0,addItemButton:!0,itemAddOptions:{enabled:!0,content:"+ Add New Item",class:"kanban-title-button btn btn-default btn-xs",footer:!1},click:function(a){var e=(a=$(a)).attr("data-eid")?a.find(".kanban-text").text():a.text(),o=a.attr("data-due-date"),s=new Date,r=s.getFullYear(),l=o?o+", "+r:s.getDate()+" "+s.toLocaleString("en",{month:"long"})+", "+r,c=a.attr("data-badge-text"),m=a.attr("data-assigned");a.find(".kanban-item-avatar").length&&a.find(".kanban-item-avatar").on("click",(function(a){a.stopPropagation()})),!$(".dropdown").hasClass("show")&&t&&n.modal("show"),n.find(".update-item-form").on("submit",(function(a){a.preventDefault()})),n.find("#title").val(e),n.find(d).next(".form-control").val(l),n.find(i).val(c).trigger("change"),n.find(".assigned").empty(),n.find(".assigned").append(v(m,!1,"50",a.attr("data-members"),32)+"<li class='avatar avatar-add-member ml-50'><span class='avatar-content'>"+feather.icons.plus.toSvg({class:"avatar-icon"})+"</li>")},buttonClick:function(a,t){var e=document.createElement("form");e.setAttribute("class","new-item-form"),e.innerHTML='<div class="form-group mb-1"><textarea class="form-control add-new-item" rows="2" placeholder="Add Content" required></textarea></div><div class="form-group mb-2"><button type="submit" class="btn btn-primary btn-sm mr-1">Add</button><button type="button" class="btn btn-outline-secondary btn-sm cancel-add-item">Cancel</button></div>',g.addForm(t,e),e.querySelector("textarea").focus(),e.addEventListener("submit",(function(a){a.preventDefault();var n=$(".kanban-board[data-id='"+t+"']");g.addElement(t,{title:"<span class='kanban-text'>"+a.target[0].value+"</span>",id:t+"-"+n.find(".kanban-item").length+1}),n.find(".kanban-item:last-child .kanban-text").before(u()),e.remove()})),$(document).on("click",".cancel-add-item",(function(){$(this).closest(e).toggle()}))},dragEl:function(a,t){$(a).find(".item-dropdown, .item-dropdown .dropdown-menu.show").removeClass("show")}});e.length&&new PerfectScrollbar(e[0]),$(".kanban-container").append(s),$.each($(".kanban-title-button"),(function(){$(this).removeClass().addClass("kanban-title-button btn btn-flat-secondary btn-sm ml-50"),Waves.init(),Waves.attach("[class*='btn-flat-']")})),$(document).on("mouseenter",".kanban-title-board",(function(){$(this).attr("contenteditable","true")})),$.each($(".kanban-board-header"),(function(){$(this).append(p())})),$(document).on("click",".delete-board",(function(){var a=$(this).closest(".kanban-board").data("id");g.removeBoard(a)})),$(document).on("click",".dropdown-item.delete-task",(function(){t=!0;var a=$(this).closest(".kanban-item").data("eid");g.removeElement(a)})),$(".add-new-btn, .cancel-add-new").on("click",(function(){l.toggle()})),s.on("submit",(function(a){a.preventDefault();var t=$(this).find(".form-control").val(),e=t.replace(/\s+/g,"-").toLowerCase();g.addBoards([{id:e,title:t}]),$(".kanban-board:last-child").find(".kanban-board-header").append(p()),l.val("").css("display","none"),$(".kanban-container").append(s),$.each($(".kanban-title-button"),(function(){$(this).removeClass().addClass("kanban-title-button btn btn-flat-secondary btn-sm ml-50"),Waves.init(),Waves.attach("[class*='btn-flat-']")}))})),n.on("hidden.bs.modal",(function(){n.find(".ql-editor")[0].innerHTML="",n.find(".nav-link-activity").removeClass("active"),n.find(".tab-pane-activity").removeClass("show active"),n.find(".nav-link-update").addClass("active"),n.find(".tab-pane-update").addClass("show active")})),n.on("shown.bs.modal",(function(){$('[data-toggle="tooltip"]').tooltip()})),$(".update-item-form").on("submit",(function(a){a.preventDefault(),n.modal("hide")})),$.each($(".kanban-item"),(function(){var a=$(this),t="<span class='kanban-text'>"+a.text()+"</span>";void 0!==a.attr("data-badge")&&void 0!==a.attr("data-badge-text")&&a.html(b(a.attr("data-badge"),a.attr("data-badge-text"))+t),void 0===a.attr("data-comments")&&void 0===a.attr("data-due-date")&&void 0===a.attr("data-assigned")||a.append(f(a.attr("data-attachments"),a.attr("data-comments"),a.attr("data-assigned"),a.attr("data-members"))),void 0!==a.attr("data-image")&&a.html(b(a.attr("data-badge"),a.attr("data-badge-text"))+"<img class='img-fluid rounded mb-50' src='"+c+"images/slider/"+a.attr("data-image")+"' height='32'/>"+t+f(a.attr("data-due-date"),a.attr("data-comments"),a.attr("data-assigned"),a.attr("data-members"))),a.on("mouseenter",(function(){a.find(".item-dropdown, .item-dropdown .dropdown-menu.show").removeClass("show")}))})),r.length&&r.on("hidden.bs.modal",(function(){r.find(".custom-file-label").empty()}))}));